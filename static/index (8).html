<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RTSP Livestream with Overlays</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/styles.css">
    <meta name="description" content="RTSP Livestream application with custom overlay functionality">
    <meta name="keywords" content="RTSP, livestream, overlay, video streaming">
</head>
<body>
    <!-- Main application container -->
    <div id="root">
        <!-- Loading state while React app initializes -->
        <div class="d-flex justify-content-center align-items-center min-vh-100">
            <div class="text-center">
                <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <h4>Loading RTSP Livestream Application...</h4>
                <p class="text-muted">Initializing video player and overlay management</p>
            </div>
        </div>
    </div>
    
    <!-- Fallback content for browsers with JavaScript disabled -->
    <noscript>
        <div class="container mt-5">
            <div class="alert alert-warning" role="alert">
                <h4 class="alert-heading">JavaScript Required</h4>
                <p>This application requires JavaScript to function properly. The RTSP livestream player and overlay management features need JavaScript enabled.</p>
                <hr>
                <p class="mb-0">Please enable JavaScript in your browser settings and refresh the page.</p>
            </div>
            
            <div class="card mt-4">
                <div class="card-header">
                    <h5>RTSP Livestream with Overlays</h5>
                </div>
                <div class="card-body">
                    <p>This application provides:</p>
                    <ul>
                        <li>RTSP video stream integration</li>
                        <li>Custom text and logo overlays</li>
                        <li>Drag-and-drop overlay positioning</li>
                        <li>Real-time overlay management</li>
                        <li>Video playback controls</li>
                    </ul>
                    <p class="text-muted">To use these features, please enable JavaScript and reload the page.</p>
                </div>
            </div>
        </div>
    </noscript>
    
    <!-- External JavaScript dependencies -->
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.24.0/dist/axios.min.js"></script>
    <script src="https://vjs.zencdn.net/7.18.1/video.min.js"></script>
    <link href="https://vjs.zencdn.net/7.18.1/video-js.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js"></script>
    
    <!-- Error handling for failed script loads -->
    <script>
        // Check if React loaded properly
        if (typeof React === 'undefined') {
            document.getElementById('root').innerHTML = `
                <div class="container mt-5">
                    <div class="alert alert-danger" role="alert">
                        <h4 class="alert-heading">Loading Error</h4>
                        <p>Failed to load required JavaScript libraries. This may be due to:</p>
                        <ul>
                            <li>Network connectivity issues</li>
                            <li>Content blocker or ad blocker interference</li>
                            <li>Firewall restrictions</li>
                        </ul>
                        <p class="mb-0">Please check your internet connection and try refreshing the page.</p>
                    </div>
                </div>
            `;
        }
    </script>
    
    <!-- Load the main React application -->
    <script type="text/babel" src="/static/app.js"></script>
    
    <!-- Initialize Feather icons after page load -->
    <script>
        // Initialize Feather icons when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        });
        
        // Error handling for the main app
        window.addEventListener('error', function(e) {
            console.error('Application error:', e.error);
            
            // Show user-friendly error message if React app fails to load
            if (e.error && e.error.message && e.error.message.includes('React')) {
                const root = document.getElementById('root');
                if (root && root.innerHTML.includes('Loading')) {
                    root.innerHTML = `
                        <div class="container mt-5">
                            <div class="alert alert-danger" role="alert">
                                <h4 class="alert-heading">Application Error</h4>
                                <p>The application failed to initialize properly. Please try:</p>
                                <ol>
                                    <li>Refreshing the page</li>
                                    <li>Clearing your browser cache</li>
                                    <li>Checking your internet connection</li>
                                </ol>
                                <p class="mb-0">If the problem persists, please contact support.</p>
                            </div>
                        </div>
                    `;
                }
            }
        });
    </script>
</body>
</html>
